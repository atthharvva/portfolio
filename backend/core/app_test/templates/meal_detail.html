{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ meal.name }} - Recipe</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

<style>
@keyframes gradientMove {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.gradient-text {
  background-size: 300% 300%;
  animation: gradientMove 8s ease infinite;
}

.blob {
  position: absolute;
  border-radius: 9999px;
  filter: blur(140px);
  opacity: 0.4;
  animation: float 20s infinite ease-in-out;
  pointer-events: none;
}

@keyframes float {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  33% { transform: translate(30px, -50px) rotate(120deg); }
  66% { transform: translate(-20px, 30px) rotate(240deg); }
}

.back-button {
  position: fixed;
  top: 30px;
  left: 30px;
  z-index: 100;
  padding: 12px 24px;
  background: rgba(30, 41, 59, 0.95);
  border: 2px solid rgba(99, 102, 241, 0.3);
  border-radius: 50px;
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
}

.back-button:hover {
  background: rgba(99, 102, 241, 0.2);
  border-color: rgba(99, 102, 241, 0.5);
  transform: translateX(-5px);
}

.progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  height: 4px;
  background: linear-gradient(90deg, #6366f1, #a855f7, #06b6d4);
  z-index: 9999;
  transform-origin: left;
}

.step-number {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6366f1, #a855f7);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  flex-shrink: 0;
}
</style>

</head>

<body class="bg-slate-950 text-slate-200 antialiased overflow-x-hidden">

<!-- Progress Bar -->
<div class="progress-bar" id="progressBar"></div>

<!-- Background Blobs -->
<div class="blob w-[600px] h-[600px] bg-purple-600 top-[-200px] left-[-200px]"></div>
<div class="blob w-[500px] h-[500px] bg-cyan-500 bottom-[-200px] right-[-200px]"></div>

<!-- Back Button -->
<a href="/gymbuddy/mealPrep/{{ meal.diet_type }}/{{ meal.category }}/" 
   class="back-button flex items-center gap-2 text-white font-semibold">
  <span>‚Üê</span>
  <span>Back to List</span>
</a>

<!-- Main Content -->
<section class="min-h-screen px-6 py-32 relative z-10">
  <div class="max-w-7xl mx-auto">

    <!-- Header -->
    <div class="text-center mb-16" data-aos="fade-up">
      <h1 class="text-5xl sm:text-6xl font-extrabold mb-6">
        <span class="gradient-text bg-gradient-to-r from-indigo-400 via-purple-400 to-cyan-400 
                     bg-clip-text text-transparent">
          {{ meal.name }}
        </span>
      </h1>
      <p class="text-xl text-slate-300 max-w-3xl mx-auto">{{ meal.description }}</p>
    </div>

    <div class="grid lg:grid-cols-3 gap-8">

      <!-- Left Column: Video & Image -->
      <div class="lg:col-span-2 space-y-8">

        <!-- YouTube Video -->
        {% if meal.youtube_url %}
        <div class="rounded-3xl overflow-hidden border-2 border-white/10 backdrop-blur-sm 
                    bg-gradient-to-br from-white/5 to-white/10"
             data-aos="fade-up">
          <div class="aspect-video">
            <iframe 
              width="100%" 
              height="100%" 
              src="{{ meal.get_youtube_embed_url }}" 
              title="{{ meal.name }} Recipe Video"
              frameborder="0" 
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
              allowfullscreen
              class="w-full h-full">
            </iframe>
          </div>
        </div>
        {% endif %}

        <!-- Meal Image -->
        {% if meal.image %}
        <div class="rounded-3xl overflow-hidden border-2 border-white/10"
             data-aos="fade-up" data-aos-delay="100">
          <img src="{{ meal.image.url }}" 
               alt="{{ meal.name }}" 
               class="w-full h-auto">
        </div>
        {% endif %}

        <!-- Instructions -->
        <div class="p-8 rounded-3xl border-2 border-white/10 backdrop-blur-sm 
                    bg-gradient-to-br from-white/5 to-white/10"
             data-aos="fade-up" data-aos-delay="200">
          <h2 class="text-3xl font-bold text-white mb-8 flex items-center gap-3">
            <span>üë®‚Äçüç≥</span>
            <span>Cooking Instructions</span>
          </h2>

          <div class="space-y-6">
            {% for instruction in instructions %}
            <div class="flex gap-4 items-start">
              <div class="step-number">{{ instruction.step_number }}</div>
              <div class="flex-1">
                <p class="text-slate-300 leading-relaxed">{{ instruction.instruction }}</p>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>

        <!-- Nutrition Tips -->
        {% if tips %}
        <div class="p-8 rounded-3xl border-2 border-green-500/20 backdrop-blur-sm 
                    bg-gradient-to-br from-green-500/5 to-emerald-500/5"
             data-aos="fade-up" data-aos-delay="300">
          <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
            <span>üí°</span>
            <span>Nutrition Tips</span>
          </h2>

          <ul class="space-y-4">
            {% for tip in tips %}
            <li class="flex gap-3 items-start">
              <span class="text-green-400 mt-1">‚úì</span>
              <span class="text-slate-300">{{ tip.tip }}</span>
            </li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}

      </div>

      <!-- Right Column: Ingredients & Info -->
      <div class="space-y-8">

        <!-- Quick Info Card -->
        <div class="p-8 rounded-3xl border-2 border-white/10 backdrop-blur-sm 
                    bg-gradient-to-br from-white/5 to-white/10"
             data-aos="fade-up">
          <h2 class="text-2xl font-bold text-white mb-6">Quick Info</h2>

          <div class="space-y-4">
            <!-- Prep Time -->
            <div class="flex justify-between items-center pb-3 border-b border-white/10">
              <span class="text-slate-400">Prep Time</span>
              <span class="font-semibold text-white">{{ meal.prep_time }} min</span>
            </div>

            <!-- Cook Time -->
            <div class="flex justify-between items-center pb-3 border-b border-white/10">
              <span class="text-slate-400">Cook Time</span>
              <span class="font-semibold text-white">{{ meal.cook_time }} min</span>
            </div>

            <!-- Total Time -->
            <div class="flex justify-between items-center pb-3 border-b border-white/10">
              <span class="text-slate-400">Total Time</span>
              <span class="font-semibold text-indigo-400">{{ meal.total_time }} min</span>
            </div>

            <!-- Servings -->
            <div class="flex justify-between items-center pb-3 border-b border-white/10">
              <span class="text-slate-400">Servings</span>
              <span class="font-semibold text-white">{{ meal.servings }}</span>
            </div>

            <!-- Difficulty -->
            <div class="flex justify-between items-center">
              <span class="text-slate-400">Difficulty</span>
              <span class="font-semibold 
                     {% if meal.difficulty == 'easy' %}text-green-400
                     {% elif meal.difficulty == 'medium' %}text-yellow-400
                     {% else %}text-red-400{% endif %}">
                {{ meal.get_difficulty_display }}
              </span>
            </div>
          </div>
        </div>

        <!-- Nutrition Facts -->
        <div class="p-8 rounded-3xl border-2 border-white/10 backdrop-blur-sm 
                    bg-gradient-to-br from-white/5 to-white/10"
             data-aos="fade-up" data-aos-delay="100">
          <h2 class="text-2xl font-bold text-white mb-6">Nutrition Facts</h2>

          <div class="space-y-4">
            <!-- Calories -->
            <div class="p-4 rounded-xl bg-indigo-500/10 border border-indigo-500/20">
              <div class="text-slate-400 text-sm mb-1">Calories</div>
              <div class="text-3xl font-bold text-indigo-400">{{ meal.calories }}</div>
            </div>

            <!-- Macros Grid -->
            <div class="grid grid-cols-3 gap-3">
              <div class="p-4 rounded-xl bg-green-500/10 border border-green-500/20 text-center">
                <div class="text-slate-400 text-xs mb-1">Protein</div>
                <div class="text-xl font-bold text-green-400">{{ meal.protein }}g</div>
              </div>
              <div class="p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/20 text-center">
                <div class="text-slate-400 text-xs mb-1">Carbs</div>
                <div class="text-xl font-bold text-yellow-400">{{ meal.carbs }}g</div>
              </div>
              <div class="p-4 rounded-xl bg-orange-500/10 border border-orange-500/20 text-center">
                <div class="text-slate-400 text-xs mb-1">Fats</div>
                <div class="text-xl font-bold text-orange-400">{{ meal.fats }}g</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Ingredients -->
        <div class="p-8 rounded-3xl border-2 border-white/10 backdrop-blur-sm 
                    bg-gradient-to-br from-white/5 to-white/10"
             data-aos="fade-up" data-aos-delay="200">
          <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
            <span>üõí</span>
            <span>Ingredients</span>
          </h2>

          <ul class="space-y-3">
            {% for ingredient in ingredients %}
            <li class="flex gap-3 items-start">
              <span class="text-indigo-400 mt-1">‚Ä¢</span>
              <div class="flex-1">
                <span class="text-white font-semibold">{{ ingredient.quantity }}</span>
                <span class="text-slate-400"> {{ ingredient.name }}</span>
              </div>
            </li>
            {% endfor %}
          </ul>
        </div>

      </div>

    </div>

  </div>
</section>

<!-- Scripts -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
AOS.init({
  duration: 1000,
  once: true,
  offset: 100,
  easing: 'ease-out-cubic'
});

window.addEventListener('scroll', () => {
  const winScroll = document.documentElement.scrollTop;
  const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  const scrolled = (winScroll / height) * 100;
  document.getElementById('progressBar').style.width = scrolled + '%';
});
</script>

</body>
</html>